
var SCREEN_WIDTH = window.innerWidth;
var SCREEN_HEIGHT = window.innerHeight;

var container;

var camera, scene;
var renderer;

//var mesh;

var mouseX = 0, mouseY = 0;

var windowHalfX = window.innerWidth / 2;
var windowHalfY = window.innerHeight / 2;

var gui, skinConfig, morphConfig;

var skincolorParams = { 
	
	Hue:		0.0917,
	Saturation: 1.0,
	Lightness:  0.878
	
	};

var hairParams = {

	Hair: false,
	Hue:		0.121,
	Saturation: 0.73,
	Lightness:  0.66
	
	};

var shapeParams = {

	Height:		0.121,
	Weight: 0.73,
	Waist:  0.66,
	Hip:		0.121,
	Leg: 0.73,
	Shoulder:  0.66,
	Arm: 0.5
	
	
	};
	
var genderParams = { 
	Sex: 'A_male'
	};
	
var basicmaterial = new THREE.MeshBasicMaterial( { 
				color: 0xFFE3C1,
				side: THREE.DoubleSide 
				} );

var facematerial = new THREE.MeshBasicMaterial( { 
				color: 0xFFE3C1,
				vertexColors: THREE.FaceColors 
				});

var material = new THREE.MeshStandardMaterial( { 
				color: 0xFFE3C1,
				roughness: 1.0, 
				metalness: 0.0, 
				shading: THREE.SmoothShading,
				vertexColors: THREE.FaceColors,
				wireframe: false 
				
				} );

var materials = [];
var skinmaterial = new THREE.MeshStandardMaterial( { 
		color: 0xFFE3C1,
		roughness: 1.0, 
		metalness: 0.0, 
		shading: THREE.SmoothShading,
		vertexColors: THREE.FaceColors,
		wireframe: false 
		
		} );
		
var pantsmaterial = new THREE.MeshStandardMaterial( { 
		color: 0xFF69B4,
		roughness: 1.0, 
		metalness: 0.0, 
		shading: THREE.SmoothShading,
		vertexColors: THREE.FaceColors,
		wireframe: false 
		
		} );					
materials.push( skinmaterial );
materials.push( pantsmaterial );
		
var male_geometry, male_mesh, female_geometry, female_mesh;

document.addEventListener( 'mousemove', onDocumentMouseMove, false );

init();
animate();

function init() {

	container = document.getElementById( 'container' );

	// RENDERER

	renderer = new THREE.WebGLRenderer( { antialias: true } );
	renderer.setClearColor( 0xffffff );
	renderer.setPixelRatio( window.devicePixelRatio );
	renderer.setSize( SCREEN_WIDTH, SCREEN_HEIGHT );
	container.appendChild( renderer.domElement );
	
	camera = new THREE.PerspectiveCamera( 45, window.innerWidth / window.innerHeight, 1, 100000 );
	camera.position.set( 0, 0, 3 );

	scene = new THREE.Scene();
	scene.add( camera );
	
	// LIGHTS

	var dirLight = new THREE.DirectionalLight( 0xffffff, 1 );
	dirLight.position.set( 0, 140, 500 ).normalize();
	camera.add( dirLight );
	camera.add( dirLight.target );

	// CHARACTER
	loadMale();
	
	gui = new dat.GUI();
	gui.width = Math.round( window.innerWidth/5 );
	setupGenderGUI();
	setupSkinColorGUI();
	setupHairGUI();
	setupMorphsGUI();
	gui.open();

	window.addEventListener( 'resize', onWindowResize, false );

	controls = new THREE.OrbitControls( camera, renderer.domElement );
	
	controls.addEventListener( 'change', render );

}

function removeObjectByName( objectname ) {
	var maleObject = scene.getObjectByName( objectname );
	if( typeof maleObject != "undefined" ) {
		scene.remove( maleObject );
	}	
}

function loadMale() {
		
	var loader = new THREE.PLYLoader();
	loader.load( './MaleFemale_burn/male2.ply', function ( male_geometry ) {
		//geometry.computeFaceNormals();
		male_geometry.computeVertexNormals();
							
		male_mesh = new THREE.Mesh( male_geometry, materials[0] );
		male_mesh.name = "A_male";
		male_mesh.rotation.x = - Math.PI / 2;
		male_mesh.scale.multiplyScalar( 0.001 ); // scale to mm

		var pants = [10846,10847,10848,10849,10850,10851,10852,10853,10854,10855,10856,10857,10858,10859,10860,10885,10886,10888,10889,10890,10891,10892,10893,10894,10895,10896,10897,10898,10899,10900,10925,10926,10927,10928,10929,10930,10931,10932,10933,10934,10935,10936,10937,10938,10939,10940,10941,10942,10943,10944,10945,10946,10947,10948,10965,10966,10967,10968,10969,10970,10971,10972,10973,10974,10975,10976,10977,10978,10979,10980,10981,10982,10983,10984,10985,10986,10987,10988,10989,10990,10991,10992,10993,10994,10995,10996,11037,11038,11039,11040,11041,11042,11043,11044,11197,11198,11199,11200,11201,11202,11203,11204,11205,11206,11207,11208,11209,11210,11211,11212,11213,11214,11215,11216,11217,11218,11219,11220,11221,11222,11223,11224,11225,11226,11227,11228,11229,11230,11231,11232,11233,11234,11235,11236,11237,11238,11239,11240,11241,11242,11243,11244,11245,11246,11247,11248,11249,11250,11251,11252,11253,11254,11255,11256,11257,11258,11259,11260,11261,11262,11263,11264,11265,11266,11267,11268,11269,11270,11271,11272,11273,11274,11275,11276,11277,11278,11279,11280,11281,11282,11283,11284,11285,11286,11287,11288,11289,11290,11291,11292,12760,12761,12762,12763,12764,12765,12766,12767,13008,13009,13010,13011,13012,13013,13014,13015,13016,13017,13018,13019,13020,13021,13022,13023,13024,13025,13026,13027,13028,13029,13030,13031,13048,13049,13050,13051,13052,13053,13054,13055,13056,13057,13058,13059,13060,13061,13062,13063,13064,13065,13066,13067,13068,13069,13070,13071,13072,13073,13074,13075,13076,13077,13078,13079,13080,13081,13082,13083,13084,13085,13086,13087,13088,13089,13090,13091,13092,13093,15773,15774,15775,15776,15777,15778,15779,15780,15783,15797,15798,15799,15800,15801,15802,15803,15804,15805,15806,15807,15808,15809,15810,15811,15812,15813,15814,15815,15816,15817,15818,15819,15820,15845,15846,15847,15848,15849,15850,15851,15852,15853,15854,15855,15856,15857,15858,15859,15860,16085,16086,16087,16088,16089,16090,16091,16092,16093,16094,16095,16096,16097,16098,16099,16100,16125,16126,16127,16128,16129,16130,16131,16132,16133,16134,16135,16136,16137,16138,16139,16140,16141,16142,16143,16144,16145,16146,16147,16148,16157,16158,16159,16160,16161,16162,16163,16164,16197,16198,16199,16200,16201,16202,16203,16204,16205,16206,16207,16208,16209,16210,16211,16212,16213,16214,16215,16216,16217,16218,16219,16220,16221,16222,16223,16224,16225,16226,16227,16228,16229,16230,16231,16232,16233,16234,16235,16236,16237,16238,16239,16240,16241,16242,16243,16244,16245,16246,16247,16248,16249,16250,16251,16252,16253,16254,16255,16256,16257,16258,16259,16260,16261,16262,16263,16264,16265,16266,16267,16268,16269,16270,16271,16272,16273,16274,16275,16276,16277,16278,16279,16280,16281,16282,16283,16284,16285,16286,16287,16288,16289,16290,16291,16292,16293,16294,16295,16296,16297,16298,16299,16300,16301,16302,16303,16304,16305,16306,16307,16308,16309,16310,16311,16312,16313,16314,16315,16316,17876,17877,17878,17879,17880,17881,17882,17883,17884,17885,17886,17887,17888,17889,17890,17891,17892,17893,17894,17895,17896,17897,17898,17899,17900,17901,17902,17903,17904,17905,17906,17907,17908,17909,17910,17911,17912,17913,17914,17915,18915,18916,18917,18918,18919,18920,18921,18922,18923,18924,18925,18926,18927,18928,18929,18930,18941,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,470,471,472,473,474,475,476,477,641,642,643,644,645,646,647,648,649,650,651,652,653,654,655,656,665,666,667,668,669,670,671,672,673,674,675,676,677,678,679,680,705,706,707,708,709,710,711,712,713,714,715,716,717,718,719,720,721,722,723,724,725,726,727,1368,1369,1370,1371,1372,1373,1374,1375,1376,1377,1378,1379,1380,1381,1382,1383,1408,1409,1411,1412,1413,1414,1415,1416,1417,1418,1419,1420,1421,1422,1423,1448,1449,1450,1451,1452,1453,1454,1455,1456,1457,1458,1459,1460,1461,1462,1463,1464,1465,1466,1467,1468,1469,1470,1471,1488,1489,1490,1491,1492,1493,1494,1495,1496,1497,1498,1499,1500,1501,1502,1503,1504,1505,1506,1507,1508,1509,1510,1511,1512,1513,1514,1515,1516,1517,1518,1519,1560,1561,1562,1563,1564,1565,1566,1567,1720,1721,1722,1723,1724,1725,1726,1727,1728,1729,1730,1731,1732,1733,1734,1735,1736,1737,1738,1739,1740,1741,1742,1743,1744,1745,1746,1747,1748,1749,1750,1751,1752,1753,1754,1755,1756,1757,1758,1759,1760,1761,1762,1763,1764,1765,1766,1767,1768,1769,1770,1771,1772,1773,1774,1775,1776,1777,1778,1779,1780,1781,1782,1783,1784,1785,1786,1787,1788,1789,1790,1791,1792,1793,1794,1795,1796,1797,1798,1799,1800,1801,1802,1803,1804,1805,1806,1807,1808,1809,1810,1811,1812,1813,1814,1815,3283,3284,3285,3286,3287,3288,3289,3290,3531,3532,3533,3534,3535,3536,3537,3538,3539,3540,3541,3542,3543,3544,3545,3546,3547,3548,3549,3550,3551,3552,3553,3554,3571,3572,3573,3574,3575,3576,3577,3578,3579,3580,3581,3582,3583,3584,3585,3586,3587,3588,3589,3590,3591,3592,3593,3594,3595,3596,3597,3598,3599,3600,3601,3602,3603,3604,3605,3606,3607,3608,3609,3610,3611,3612,3613,3614,3615,3616,6296,6297,6298,6299,6300,6301,6302,6303,6306,6320,6321,6322,6323,6324,6325,6326,6327,6328,6329,6330,6331,6332,6333,6334,6335,6336,6337,6338,6339,6340,6341,6342,6343,6368,6369,6370,6371,6372,6373,6374,6375,6376,6377,6378,6379,6380,6381,6382,6383,6608,6609,6610,6611,6612,6613,6614,6615,6616,6617,6618,6619,6620,6621,6622,6623,6648,6649,6650,6651,6652,6653,6654,6655,6656,6657,6658,6659,6660,6661,6662,6663,6664,6665,6666,6667,6668,6669,6670,6671,6680,6681,6682,6683,6684,6685,6686,6687,6720,6721,6722,6723,6724,6725,6726,6727,6728,6729,6730,6731,6732,6733,6734,6735,6736,6737,6738,6739,6740,6741,6742,6743,6744,6745,6746,6747,6748,6749,6750,6751,6752,6753,6754,6755,6756,6757,6758,6759,6760,6761,6762,6763,6764,6765,6766,6767,6768,6769,6770,6771,6772,6773,6774,6775,6776,6777,6778,6779,6780,6781,6782,6783,6784,6785,6786,6787,6788,6789,6790,6791,6792,6793,6794,6795,6796,6797,6798,6799,6800,6801,6802,6803,6804,6805,6806,6807,6808,6809,6810,6811,6812,6813,6814,6815,6816,6817,6818,6819,6820,6821,6822,6823,6824,6825,6826,6827,6828,6829,6830,6831,6832,6833,6834,6835,6836,6837,6838,6839,8399,8400,8401,8402,8403,8404,8405,8406,8407,8408,8409,8410,8411,8412,8413,8414,8415,8416,8417,8418,8419,8420,8421,8422,8423,8424,8425,8426,8427,8428,8429,8430,8431,8432,8433,8434,8435,8436,8437,8438,9438,9439,9440,9441,9442,9443,9444,9445,9446,9447,9448,9449,9450,9451,9452,9453,9464,9891,9892,9893,9894,9895,9896,9897,9898,9899,9900,9901,9902,9903,9904,9905,9906,9947,9948,9949,9950,9951,9952,9953,9954,10118,10119,10120,10121,10122,10123,10124,10125,10126,10127,10128,10129,10130,10131,10132,10133,10142,10143,10144,10145,10146,10147,10148,10149,10150,10151,10152,10153,10154,10155,10156,10157,10182,10183,10184,10185,10186,10187,10188,10189,10190,10191,10192,10193,10194,10195,10196,10197,10198,10199,10200,10201,10202,10203,10204,10845
];
		for (let i in pants) {
			var face = male_geometry.faces[ pants[i] ];
			face.color.setHex( 0xFF69B4 );

		}				
		scene.add( male_mesh );
	});		
	
}


function loadFemale() {
	
	var loader = new THREE.PLYLoader();
	loader.load( './MaleFemale_burn/female2.ply', function ( female_geometry ) {

		//geometry.computeFaceNormals();
		female_geometry.computeVertexNormals();

		female_mesh = new THREE.Mesh( female_geometry, materials[0] );
		female_mesh.name = "A_female";
		female_mesh.rotation.x = - Math.PI / 2;
		female_mesh.scale.multiplyScalar( 0.001 ); // scale to mm

		
		var bra = [8072,8073,8074,8075,8076,8077,8078,8079,8080,8081,8082,8083,8084,8085,8086,8087,8088,8091,8092,8093,8094,8113,8114,8119,8120,8121,8122,8123,8124,8125,8126,8127,8128,8129,8130,8131,8132,8133,8134,8135,8136,8137,8138,8139,8140,8141,8142,8143,8144,8145,8146,8147,8148,8149,8150,8151,8152,8439,8440,8441,8442,8443,8444,8445,8446,9787,9788,9789,9790,9791,9792,9793,9794,9795,9796,9797,9798,9799,9800,9801,9802,9851,9852,9853,9854,9855,9856,9857,9858,9992,9993,9994,9995,9996,9997,9998,9999,10213,10214,10215,10216,10217,10218,10219,10220,10221,10222,10223,10224,10225,10226,10227,10228,10301,10309,10310,10311,10312,10465,11025,11026,11027,11028,11029,11030,11031,11032,15073,15074,15075,15076,15077,15078,15079,15080,15081,15082,15083,15084,15085,15086,15087,15088,15462,15463,15464,15465,15466,15467,15468,15469,15494,15495,15496,15497,15498,15499,15500,15501,15534,15535,15536,15537,15550,15551,15552,15553,15582,15583,15584,15585,15586,15587,15588,15589,15590,15591,15592,15593,15595,15596,15597,15598,15599,15600,15601,15602,15603,15604,15605,15606,15607,15608,15609,17008,17009,17010,17011,17012,17013,17014,17015,17016,17017,17018,17019,17020,17021,17022,17023,17078,17079,17080,17081,17082,17083,17084,17085,17086,17087,17088,17089,17090,17091,17092,17093,17094,17095,17096,17097,17098,17099,17100,17101,17102,17103,17104,17105,17106,17107,17108,17109,17110,17111,17112,17113,17114,17115,17116,17117,17118,17119,17120,17121,17122,17123,17124,17125,17126,17127,17128,17129,17130,17131,17132,17133,17134,17135,17136,17137,17138,17139,17140,17141,17142,17143,17144,17145,17146,17147,17148,17149,17150,17151,17152,17153,17154,17155,17156,17157,17158,17159,17160,17161,17162,17163,17164,17165,17166,17167,17168,17169,17170,17171,17172,17173,17174,17175,17176,17177,17178,17179,17180,17181,17182,17183,17184,17185,17186,17187,17188,17189,17190,17191,17192,17193,17194,17195,17196,17197,17198,17199,17200,17201,17202,17203,17204,17205,17206,17207,17208,17209,17210,17211,17212,17213,17407,17408,17409,17410,17411,17412,17413,17414,17415,17416,17417,17418,17419,17420,17421,17422,17423,17424,17425,17426,17427,17428,17429,17430,17431,17432,17433,17434,17435,17436,17437,17438,17439,17440,17441,17442,17443,17444,17445,17446,17447,17448,17449,17450,17451,17452,17453,17454,17455,17456,17457,17458,17459,17460,17461,17462,17463,17464,17465,17466,17467,17468,17469,17470,17471,17472,17473,17474,17475,17477,17478,17479,17480,17481,17486,17487,17488,17489,17494,17495,17496,17497,17502,17503,17504,17505,17510,17511,17516,17517,17526,17527,17528,17529,17530,17531,17532,17533,17534,17535,17536,17537,17538,17539,17540,17541,17542,17543,17544,17545,17546,17547,17548,17549,17550,17551,17552,17553,17554,17555,17556,17557,17558,17559,17560,17561,17562,17563,17564,17565,17568,17569,17570,17571,17590,17591,17596,17597,17598,17599,17600,17601,17602,17603,17604,17605,17606,17607,17608,17609,17610,17611,17612,17613,17614,17615,17616,17617,17618,17619,17620,17621,17622,17623,17624,17625,17626,17627,17628,17629,17916,17917,17918,17919,17920,17921,17922,17923,318,319,320,321,322,323,324,325,374,375,376,377,378,379,380,381,515,516,517,518,519,520,521,522,736,737,738,739,740,741,742,743,744,745,746,747,748,749,750,751,824,832,833,834,835,988,1548,1549,1550,1551,1552,1553,1554,1555,5596,5597,5598,5599,5600,5601,5602,5603,5604,5605,5606,5607,5608,5609,5610,5611,5985,5986,5987,5988,5989,5990,5991,5992,6017,6018,6019,6020,6021,6022,6024,6057,6058,6059,6060,6073,6074,6075,6076,6105,6106,6107,6108,6109,6110,6111,6112,6113,6114,6115,6116,6118,6119,6120,6121,6122,6123,6124,6125,6126,6127,6128,6129,6130,6131,6132,7531,7532,7533,7534,7535,7536,7537,7538,7539,7540,7541,7542,7543,7544,7545,7546,7601,7602,7603,7604,7605,7606,7607,7608,7609,7610,7611,7612,7613,7614,7615,7616,7617,7618,7619,7620,7621,7622,7623,7624,7625,7626,7627,7628,7629,7630,7631,7632,7633,7634,7635,7636,7637,7638,7639,7640,7641,7642,7643,7644,7645,7646,7647,7648,7649,7650,7651,7652,7653,7654,7655,7656,7657,7658,7659,7660,7661,7662,7663,7664,7665,7666,7667,7668,7669,7670,7671,7672,7673,7674,7675,7676,7677,7678,7679,7680,7681,7682,7683,7684,7685,7686,7687,7688,7689,7690,7691,7692,7693,7694,7695,7696,7697,7698,7699,7700,7701,7702,7703,7704,7705,7706,7707,7708,7709,7710,7711,7712,7713,7714,7715,7716,7717,7718,7719,7720,7721,7722,7723,7724,7725,7726,7727,7728,7729,7730,7731,7732,7733,7734,7735,7736,7930,7931,7932,7933,7934,7935,7936,7937,7938,7939,7940,7941,7942,7943,7944,7945,7946,7947,7948,7949,7950,7951,7952,7953,7954,7955,7956,7957,7958,7959,7960,7961,7962,7963,7964,7965,7966,7967,7968,7969,7970,7971,7972,7973,7974,7975,7976,7977,7978,7979,7980,7981,7982,7983,7984,7985,7986,7991,7992,7993,7994,7995,7996,8001,8002,8003,8004,8009,8010,8011,8012,8017,8018,8019,8020,8025,8026,8027,8028,8033,8034,8039,8040,8049,8050,8051,8052,8053,8054,8055,8056,8057,8058,8059,8060,8061,8062,8063,8064,8065,8066,8067,8068,8069,8070,8071,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
];
		var pants = [10846,10847,10848,10849,10850,10851,10852,10853,10854,10855,10856,10857,10858,10859,10860,10885,10886,10888,10889,10890,10891,10892,10893,10894,10895,10896,10897,10898,10899,10900,10925,10926,10927,10928,10929,10930,10931,10932,10933,10934,10935,10936,10937,10938,10939,10940,10941,10942,10943,10944,10945,10946,10947,10948,10965,10966,10967,10968,10969,10970,10971,10972,10973,10974,10975,10976,10977,10978,10979,10980,10981,10982,10983,10984,10985,10986,10987,10988,10989,10990,10991,10992,10993,10994,10995,10996,11037,11038,11039,11040,11041,11042,11043,11044,11197,11198,11199,11200,11201,11202,11203,11204,11205,11206,11207,11208,11209,11210,11211,11212,11213,11214,11215,11216,11217,11218,11219,11220,11221,11222,11223,11224,11225,11226,11227,11228,11229,11230,11231,11232,11233,11234,11235,11236,11237,11238,11239,11240,11241,11242,11243,11244,11245,11246,11247,11248,11249,11250,11251,11252,11253,11254,11255,11256,11257,11258,11259,11260,11261,11262,11263,11264,11265,11266,11267,11268,11269,11270,11271,11272,11273,11274,11275,11276,11277,11278,11279,11280,11281,11282,11283,11284,11285,11286,11287,11288,11289,11290,11291,11292,12760,12761,12762,12763,12764,12765,12766,12767,13008,13009,13010,13011,13012,13013,13014,13015,13016,13017,13018,13019,13020,13021,13022,13023,13024,13025,13026,13027,13028,13029,13030,13031,13048,13049,13050,13051,13052,13053,13054,13055,13056,13057,13058,13059,13060,13061,13062,13063,13064,13065,13066,13067,13068,13069,13070,13071,13072,13073,13074,13075,13076,13077,13078,13079,13080,13081,13082,13083,13084,13085,13086,13087,13088,13089,13090,13091,13092,13093,15773,15774,15775,15776,15777,15778,15779,15780,15783,15797,15798,15799,15800,15801,15802,15803,15804,15805,15806,15807,15808,15809,15810,15811,15812,15813,15814,15815,15816,15817,15818,15819,15820,15845,15846,15847,15848,15849,15850,15851,15852,15853,15854,15855,15856,15857,15858,15859,15860,16085,16086,16087,16088,16089,16090,16091,16092,16093,16094,16095,16096,16097,16098,16099,16100,16125,16126,16127,16128,16129,16130,16131,16132,16133,16134,16135,16136,16137,16138,16139,16140,16141,16142,16143,16144,16145,16146,16147,16148,16157,16158,16159,16160,16161,16162,16163,16164,16197,16198,16199,16200,16201,16202,16203,16204,16205,16206,16207,16208,16209,16210,16211,16212,16213,16214,16215,16216,16217,16218,16219,16220,16221,16222,16223,16224,16225,16226,16227,16228,16229,16230,16231,16232,16233,16234,16235,16236,16237,16238,16239,16240,16241,16242,16243,16244,16245,16246,16247,16248,16249,16250,16251,16252,16253,16254,16255,16256,16257,16258,16259,16260,16261,16262,16263,16264,16265,16266,16267,16268,16269,16270,16271,16272,16273,16274,16275,16276,16277,16278,16279,16280,16281,16282,16283,16284,16285,16286,16287,16288,16289,16290,16291,16292,16293,16294,16295,16296,16297,16298,16299,16300,16301,16302,16303,16304,16305,16306,16307,16308,16309,16310,16311,16312,16313,16314,16315,16316,17876,17877,17878,17879,17880,17881,17882,17883,17884,17885,17886,17887,17888,17889,17890,17891,17892,17893,17894,17895,17896,17897,17898,17899,17900,17901,17902,17903,17904,17905,17906,17907,17908,17909,17910,17911,17912,17913,17914,17915,18915,18916,18917,18918,18919,18920,18921,18922,18923,18924,18925,18926,18927,18928,18929,18930,18941,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,470,471,472,473,474,475,476,477,641,642,643,644,645,646,647,648,649,650,651,652,653,654,655,656,665,666,667,668,669,670,671,672,673,674,675,676,677,678,679,680,705,706,707,708,709,710,711,712,713,714,715,716,717,718,719,720,721,722,723,724,725,726,727,1368,1369,1370,1371,1372,1373,1374,1375,1376,1377,1378,1379,1380,1381,1382,1383,1408,1409,1411,1412,1413,1414,1415,1416,1417,1418,1419,1420,1421,1422,1423,1448,1449,1450,1451,1452,1453,1454,1455,1456,1457,1458,1459,1460,1461,1462,1463,1464,1465,1466,1467,1468,1469,1470,1471,1488,1489,1490,1491,1492,1493,1494,1495,1496,1497,1498,1499,1500,1501,1502,1503,1504,1505,1506,1507,1508,1509,1510,1511,1512,1513,1514,1515,1516,1517,1518,1519,1560,1561,1562,1563,1564,1565,1566,1567,1720,1721,1722,1723,1724,1725,1726,1727,1728,1729,1730,1731,1732,1733,1734,1735,1736,1737,1738,1739,1740,1741,1742,1743,1744,1745,1746,1747,1748,1749,1750,1751,1752,1753,1754,1755,1756,1757,1758,1759,1760,1761,1762,1763,1764,1765,1766,1767,1768,1769,1770,1771,1772,1773,1774,1775,1776,1777,1778,1779,1780,1781,1782,1783,1784,1785,1786,1787,1788,1789,1790,1791,1792,1793,1794,1795,1796,1797,1798,1799,1800,1801,1802,1803,1804,1805,1806,1807,1808,1809,1810,1811,1812,1813,1814,1815,3283,3284,3285,3286,3287,3288,3289,3290,3531,3532,3533,3534,3535,3536,3537,3538,3539,3540,3541,3542,3543,3544,3545,3546,3547,3548,3549,3550,3551,3552,3553,3554,3571,3572,3573,3574,3575,3576,3577,3578,3579,3580,3581,3582,3583,3584,3585,3586,3587,3588,3589,3590,3591,3592,3593,3594,3595,3596,3597,3598,3599,3600,3601,3602,3603,3604,3605,3606,3607,3608,3609,3610,3611,3612,3613,3614,3615,3616,6296,6297,6298,6299,6300,6301,6302,6303,6306,6320,6321,6322,6323,6324,6325,6326,6327,6328,6329,6330,6331,6332,6333,6334,6335,6336,6337,6338,6339,6340,6341,6342,6343,6368,6369,6370,6371,6372,6373,6374,6375,6376,6377,6378,6379,6380,6381,6382,6383,6608,6609,6610,6611,6612,6613,6614,6615,6616,6617,6618,6619,6620,6621,6622,6623,6648,6649,6650,6651,6652,6653,6654,6655,6656,6657,6658,6659,6660,6661,6662,6663,6664,6665,6666,6667,6668,6669,6670,6671,6680,6681,6682,6683,6684,6685,6686,6687,6720,6721,6722,6723,6724,6725,6726,6727,6728,6729,6730,6731,6732,6733,6734,6735,6736,6737,6738,6739,6740,6741,6742,6743,6744,6745,6746,6747,6748,6749,6750,6751,6752,6753,6754,6755,6756,6757,6758,6759,6760,6761,6762,6763,6764,6765,6766,6767,6768,6769,6770,6771,6772,6773,6774,6775,6776,6777,6778,6779,6780,6781,6782,6783,6784,6785,6786,6787,6788,6789,6790,6791,6792,6793,6794,6795,6796,6797,6798,6799,6800,6801,6802,6803,6804,6805,6806,6807,6808,6809,6810,6811,6812,6813,6814,6815,6816,6817,6818,6819,6820,6821,6822,6823,6824,6825,6826,6827,6828,6829,6830,6831,6832,6833,6834,6835,6836,6837,6838,6839,8399,8400,8401,8402,8403,8404,8405,8406,8407,8408,8409,8410,8411,8412,8413,8414,8415,8416,8417,8418,8419,8420,8421,8422,8423,8424,8425,8426,8427,8428,8429,8430,8431,8432,8433,8434,8435,8436,8437,8438,9438,9439,9440,9441,9442,9443,9444,9445,9446,9447,9448,9449,9450,9451,9452,9453,9464,9891,9892,9893,9894,9895,9896,9897,9898,9899,9900,9901,9902,9903,9904,9905,9906,9947,9948,9949,9950,9951,9952,9953,9954,10118,10119,10120,10121,10122,10123,10124,10125,10126,10127,10128,10129,10130,10131,10132,10133,10142,10143,10144,10145,10146,10147,10148,10149,10150,10151,10152,10153,10154,10155,10156,10157,10182,10183,10184,10185,10186,10187,10188,10189,10190,10191,10192,10193,10194,10195,10196,10197,10198,10199,10200,10201,10202,10203,10204,10845
];
		for (let i in pants) {
			var face = female_geometry.faces[ pants[i] ];
			face.color.setHex( 0xFF69B4 );
		}
		for (let i in bra) {
			var face = female_geometry.faces[ bra[i] ];
			face.color.setHex( 0xFF69B4 );
		}
		scene.add( female_mesh );
	});
	
}

function setupGenderGUI() {

	var GenderGUI = gui.addFolder( "Gender" );

	GenderGUI.add( genderParams, 'Sex', { 'Male': 'A_male', 'Female': 'A_female' } ).onChange( switchSex );
	
	GenderGUI.open();
}

function setupSkinColorGUI() {

	var SkinColorGUI = gui.addFolder( "Skin Tone" );
	
	SkinColorGUI.add( skincolorParams, "Hue", 0.0, 1.0, 0.025 ).name( "Hue" ).onChange( changeSkinColor );
	SkinColorGUI.add( skincolorParams, "Saturation", 0.0, 1.0, 0.025 ).name( "Saturation" ).onChange( changeSkinColor );
	SkinColorGUI.add( skincolorParams, "Lightness", 0.0, 1.0, 0.025 ).name( "Lightness" ).onChange( changeSkinColor );
	
	/*SkinColorGUI.add( 'Skin Tone', material.color.getHex() , function( val ) {

		material.color.setHex( val );
		animate();

	}, true );*/

	SkinColorGUI.open();
}

function setupHairGUI() {

	var HairGUI = gui.addFolder( "Hair" );
	
	HairGUI.add( hairParams, 'Hair').onChange( function() {
	});

	HairGUI.add( hairParams, "Hue", 0.0, 1.0, 0.025 ).name( "Hue" ).onChange( render );
	HairGUI.add( hairParams, "Saturation", 0.0, 1.0, 0.025 ).name( "Saturation" ).onChange( render );
	HairGUI.add( hairParams, "Lightness", 0.0, 1.0, 0.025 ).name( "Lightness" ).onChange( render );
				
	HairGUI.open();

}

function setupMorphsGUI() {

	var MorphGui = gui.addFolder( "Body Measurements" );

	MorphGui.add( shapeParams, "Height", 0.0, 1.0, 0.025 ).name( "Height" ).onChange( render );
	MorphGui.add( shapeParams, "Weight", 0.0, 1.0, 0.025 ).name( "Weight" ).onChange( render );
	MorphGui.add( shapeParams, "Waist", 0.0, 1.0, 0.025 ).name( "Waist" ).onChange( render );

	MorphGui.open();

}

function changeSkinColor() {
	var skinColor = new THREE.Color();
	skinColor.setHSL( skincolorParams.Hue, skincolorParams.Saturation, skincolorParams.Lightness );
	skinmaterial.color.setHex( skinColor.getHex() );
	
}

function switchSex() {
	if( genderParams.Sex == 'A_male' ) {
	
		removeObjectByName( 'A_female' );
		loadMale();	
	
	}	
	else if( genderParams.Sex == 'A_female' ) {
	
		removeObjectByName( 'A_male' );
		loadFemale();					
	}
}

function onWindowResize() {

	windowHalfX = window.innerWidth / 2;
	windowHalfY = window.innerHeight / 2;

	camera.aspect = window.innerWidth / window.innerHeight;
	camera.updateProjectionMatrix();

	renderer.setSize( window.innerWidth, window.innerHeight );

}

function onDocumentMouseMove( event ) {

	mouseX = ( event.clientX - windowHalfX ) * 10;
	mouseY = ( event.clientY - windowHalfY ) * 10;

}

function animate() {

	requestAnimationFrame( animate );

	controls.update();

	render();

}

function render() {
	
	renderer.render( scene, camera );

}

